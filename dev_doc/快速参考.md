# iFocus è®¤è¯åŠŸèƒ½ - å¿«é€Ÿå‚è€ƒ

## ğŸ¯ å½“å‰çŠ¶æ€

### âœ… å·²å®Œæˆ
- ç™»å½•çŠ¶æ€æŒä¹…åŒ–ï¼ˆæ— éœ€æ¯æ¬¡å¯åŠ¨é‡æ–°ç™»å½•ï¼‰
- è®¤è¯æŠ½è±¡å±‚ï¼ˆæ”¯æŒ Tauri + Webï¼‰
- Token è‡ªåŠ¨éªŒè¯
- å®Œæ•´æ–‡æ¡£

### ğŸ“‹ å¾…ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰
1. è¿ç§»åˆ° `githubSyncV2.ts`ï¼ˆ2-4å°æ—¶ï¼‰
2. Tauri Store åŠ å¯†ï¼ˆ4-6å°æ—¶ï¼‰
3. Web åç«¯ APIï¼ˆ8-12å°æ—¶ï¼Œå¦‚éœ€ Web éƒ¨ç½²ï¼‰
4. Token åˆ·æ–°ï¼ˆ6-8å°æ—¶ï¼Œä¸æ¨èï¼‰

## ğŸ“š æ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | ç”¨é€” | é˜…è¯»æ—¶é—´ |
|------|------|----------|
| [è®¤è¯åŠŸèƒ½æ”¹è¿›æ€»ç»“](./è®¤è¯åŠŸèƒ½æ”¹è¿›æ€»ç»“.md) | ğŸ“Œ å®Œæ•´æ¦‚è§ˆ | 5åˆ†é’Ÿ |
| [è®¤è¯å±‚æ¶æ„è®¾è®¡](./è®¤è¯å±‚æ¶æ„è®¾è®¡.md) | è¯¦ç»†æ¶æ„ | 10åˆ†é’Ÿ |
| [ç™»å½•çŠ¶æ€æŒä¹…åŒ–](./ç™»å½•çŠ¶æ€æŒä¹…åŒ–.md) | æŒä¹…åŒ–åŸç† | 3åˆ†é’Ÿ |
| [ç™»å½•çŠ¶æ€æµ‹è¯•æŒ‡å—](./ç™»å½•çŠ¶æ€æµ‹è¯•æŒ‡å—.md) | æµ‹è¯•æ­¥éª¤ | 10åˆ†é’Ÿ |
| [è¿ç§»åˆ°è®¤è¯æŠ½è±¡å±‚æŒ‡å—](./è¿ç§»åˆ°è®¤è¯æŠ½è±¡å±‚æŒ‡å—.md) | è¿ç§»æŒ‡å— | 5åˆ†é’Ÿ |
| [å¾…ä¼˜åŒ–é¡¹å®æ–½è®¡åˆ’](./å¾…ä¼˜åŒ–é¡¹å®æ–½è®¡åˆ’.md) | ä¼˜åŒ–è®¡åˆ’ | 15åˆ†é’Ÿ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æµ‹è¯•æŒä¹…åŒ–ç™»å½•
```bash
# 1. å¯åŠ¨åº”ç”¨
npm run tauri:dev

# 2. ç‚¹å‡»"è®¾ç½®" â†’ "ä½¿ç”¨ GitHub ç™»å½•"
# 3. å®Œæˆæˆæƒ
# 4. å…³é—­åº”ç”¨
# 5. é‡æ–°å¯åŠ¨ â†’ è‡ªåŠ¨ç™»å½• âœ…
```

### ä½¿ç”¨æ–°æ¶æ„
```typescript
// å½“å‰ä½¿ç”¨ï¼ˆå·²åŒ…å«æŒä¹…åŒ–ï¼‰
import * as GitHubSync from './services/githubSync';

// æ¨èä½¿ç”¨ï¼ˆæ–°æ¶æ„ï¼‰
import * as GitHubSync from './services/githubSyncV2';
import { getAuthProvider } from './services/auth';

// API å®Œå…¨å…¼å®¹
await GitHubSync.startGitHubAuth();
await GitHubSync.handleOAuthCallback(code);
```

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        åº”ç”¨å±‚ (Components)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GitHub Sync Service V2          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Auth Factory                  â”‚
â”‚    (è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒ)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   Tauri    â”‚     â”‚    Web     â”‚
â”‚  Provider  â”‚     â”‚  Provider  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”‘ æ ¸å¿ƒ API

### è®¤è¯ç›¸å…³
```typescript
// å¯åŠ¨ç™»å½•
await startGitHubAuth();

// å¤„ç†å›è°ƒ
await handleOAuthCallback(code);

// éªŒè¯ token
await validateToken();

// åˆå§‹åŒ–ï¼ˆæ¨èï¼‰
const authState = await initializeAuth();

// ç™»å‡º
clearAuth();
```

### æ•°æ®åŒæ­¥
```typescript
// ä¸Šä¼ åˆ° GitHub Gist
await syncToGitHub(data);

// ä» GitHub Gist ä¸‹è½½
const data = await syncFromGitHub();
```

### çŠ¶æ€æŸ¥è¯¢
```typescript
// æ£€æŸ¥ç™»å½•çŠ¶æ€
const loggedIn = isLoggedIn();

// è·å–ç”¨æˆ·ä¿¡æ¯
const user = getStoredUser();

// è·å– token
const token = getStoredToken();
```

## ğŸ”§ æ–‡ä»¶ä½ç½®

### æ ¸å¿ƒä»£ç 
```
src/services/
â”œâ”€â”€ auth/                          # è®¤è¯æŠ½è±¡å±‚
â”‚   â”œâ”€â”€ types.ts                  # æ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ AuthFactory.ts            # å·¥å‚ç±»
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”œâ”€â”€ TauriAuthProvider.ts  # æ¡Œé¢ç«¯
â”‚   â”‚   â””â”€â”€ WebAuthProvider.ts    # Webç«¯
â”‚   â””â”€â”€ storage/
â”‚       â”œâ”€â”€ LocalStorageProvider.ts
â”‚       â””â”€â”€ TauriStorageProvider.ts
â”œâ”€â”€ githubSync.ts                 # æ—§ç‰ˆï¼ˆå…¼å®¹ï¼‰
â””â”€â”€ githubSyncV2.ts               # æ–°ç‰ˆï¼ˆæ¨èï¼‰
```

### Hook
```
src/hooks/
â””â”€â”€ useGitHubSync.ts              # React Hook
```

### UI
```
src/components/
â””â”€â”€ Settings.tsx                   # è®¾ç½®ç•Œé¢
```

## ğŸ› å¸¸è§é—®é¢˜

### Q: é‡å¯åéœ€è¦é‡æ–°ç™»å½•ï¼Ÿ
**A**: æ£€æŸ¥æ§åˆ¶å°ï¼Œå¯èƒ½æ˜¯ token éªŒè¯å¤±è´¥ã€‚æŸ¥çœ‹ `dev_doc/ç™»å½•çŠ¶æ€æµ‹è¯•æŒ‡å—.md`

### Q: å¦‚ä½•æ¸…é™¤ç™»å½•çŠ¶æ€ï¼Ÿ
**A**: 
```typescript
clearAuth();
// æˆ–æ‰‹åŠ¨æ¸…é™¤
localStorage.removeItem('github_access_token');
localStorage.removeItem('github_user');
```

### Q: Web éƒ¨ç½²éœ€è¦ä»€ä¹ˆï¼Ÿ
**A**: éœ€è¦å®ç°åç«¯ APIï¼Œè¯¦è§ `dev_doc/å¾…ä¼˜åŒ–é¡¹å®æ–½è®¡åˆ’.md` ä»»åŠ¡3

### Q: Token å­˜å‚¨å®‰å…¨å—ï¼Ÿ
**A**: å½“å‰ä½¿ç”¨ localStorageã€‚å¯å‡çº§åˆ° Tauri Store åŠ å¯†å­˜å‚¨ï¼Œè§ä»»åŠ¡2

### Q: å¦‚ä½•æŸ¥çœ‹ tokenï¼Ÿ
**A**: 
```javascript
// æµè§ˆå™¨æ§åˆ¶å°
localStorage.getItem('github_access_token')
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| å¯åŠ¨æ—¶éªŒè¯ | +100-300ms |
| å†…å­˜å ç”¨ | < 1KB |
| è¿è¡Œæ—¶æ€§èƒ½ | æ— å½±å“ |
| æ„å»ºå¤§å° | +10KB |

## ğŸ” å®‰å…¨æ£€æŸ¥æ¸…å•

- [x] Client Secret ä¸åœ¨å‰ç«¯ä»£ç 
- [x] Token ä»…ç”¨äº GitHub API
- [x] Token éªŒè¯è‡ªåŠ¨åŒ–
- [x] å¤±æ•ˆè‡ªåŠ¨æ¸…é™¤
- [ ] ä½¿ç”¨åŠ å¯†å­˜å‚¨ï¼ˆå¯é€‰ï¼‰
- [ ] å®ç° HTTPSï¼ˆWeb éƒ¨ç½²å¿…éœ€ï¼‰

## ğŸ“ è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
å…³é”®æ—¥å¿—ï¼š
- `âœ… Token éªŒè¯æˆåŠŸï¼Œè‡ªåŠ¨ç™»å½•` - éªŒè¯æˆåŠŸ
- `âš ï¸ Token å·²å¤±æ•ˆï¼Œå·²æ¸…é™¤ç™»å½•çŠ¶æ€` - Token å¤±æ•ˆ
- `ğŸ–¥ï¸ æ£€æµ‹åˆ° Tauri ç¯å¢ƒ` - ç¯å¢ƒæ£€æµ‹
- `ğŸŒ æ£€æµ‹åˆ° Web ç¯å¢ƒ` - ç¯å¢ƒæ£€æµ‹

### æ¸…é™¤æ•°æ®é‡æ–°æµ‹è¯•
```javascript
// æµè§ˆå™¨æ§åˆ¶å°
localStorage.clear();
location.reload();
```

### æ‰‹åŠ¨éªŒè¯ token
```bash
# æ›¿æ¢ YOUR_TOKEN
curl -H "Authorization: token YOUR_TOKEN" https://api.github.com/user
```

## ğŸ“ å­¦ä¹ è·¯å¾„

### æ–°æ‰‹
1. é˜…è¯»"è®¤è¯åŠŸèƒ½æ”¹è¿›æ€»ç»“"ï¼ˆ5åˆ†é’Ÿï¼‰
2. æµ‹è¯•æŒä¹…åŒ–ç™»å½•ï¼ˆ10åˆ†é’Ÿï¼‰
3. é˜…è¯»"ç™»å½•çŠ¶æ€æµ‹è¯•æŒ‡å—"ï¼ˆ10åˆ†é’Ÿï¼‰

### è¿›é˜¶
1. é˜…è¯»"è®¤è¯å±‚æ¶æ„è®¾è®¡"ï¼ˆ10åˆ†é’Ÿï¼‰
2. å°è¯•è¿ç§»åˆ° V2ï¼ˆ2-4å°æ—¶ï¼‰
3. å®ç°ä¸€ä¸ª Mock Providerï¼ˆç»ƒä¹ ï¼‰

### é«˜çº§
1. å®ç° Web åç«¯ APIï¼ˆ8-12å°æ—¶ï¼‰
2. å®ç° Tauri Store åŠ å¯†ï¼ˆ4-6å°æ—¶ï¼‰
3. è€ƒè™‘è¿ç§»åˆ° GitHub Appï¼ˆç ”ç©¶ï¼‰

## ğŸš¦ å†³ç­–æ ‘

```
éœ€è¦ Web éƒ¨ç½²ï¼Ÿ
â”œâ”€â”€ æ˜¯ â†’ å®æ–½ä»»åŠ¡3ï¼ˆWeb åç«¯ APIï¼‰
â”‚   â””â”€â”€ ç„¶åè€ƒè™‘ä»»åŠ¡1ï¼ˆè¿ç§»ä»£ç ï¼‰
â””â”€â”€ å¦ â†’ ä»…æ¡Œé¢åº”ç”¨
    â”œâ”€â”€ éœ€è¦æ›´é«˜å®‰å…¨æ€§ï¼Ÿ
    â”‚   â””â”€â”€ æ˜¯ â†’ å®æ–½ä»»åŠ¡2ï¼ˆTauri Storeï¼‰
    â””â”€â”€ å½“å‰åŠŸèƒ½å¤Ÿç”¨ï¼Ÿ
        â””â”€â”€ æ˜¯ â†’ æ— éœ€ä¼˜åŒ– âœ…
```

## ğŸ“ è·å–å¸®åŠ©

1. æŸ¥çœ‹ç›¸å…³æ–‡æ¡£
2. æŸ¥çœ‹ä»£ç æ³¨é‡Š
3. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
4. æäº¤ Issue

---

**æœ€åæ›´æ–°**: 2024-12-15
**ç‰ˆæœ¬**: 1.0.0

